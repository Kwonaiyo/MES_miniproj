```SQL
USE [KDTB03_MES_2]
GO
/****** Object:  StoredProcedure [dbo].[TGR_QM_Fault_I2]    Script Date: 2023-08-30 오전 11:41:49 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		권문규
-- Create date: 2023-06-27
-- Description:	양품판정된 LOT를 가지고 LOT TRACKING에 데이터 등록
-- =============================================
ALTER PROCEDURE [dbo].[TGR_QM_Fault_I2]
	@NEWLOTNO VARCHAR(30),	-- 양품판정된 물품의 LOT
	@CLOTNO   VARCHAR(30),  -- 팝업에서 받아온 원자재LOT
	@WORKER   VARCHAR(20),

	@LANG	  VARCHAR(10),
	@RS_CODE  VARCHAR(1)   OUTPUT,
	@RS_MSG	  VARCHAR(200) OUTPUT

AS
BEGIN
    -- 시간 정의
    DECLARE @LD_NOWDATE DATETIME
	       ,@LS_NOWDATE VARCHAR(10)
	    SET @LD_NOWDATE = GETDATE()
	    SET @LS_NOWDATE = CONVERT(VARCHAR, @LD_NOWDATE, 23)

	DECLARE @LS_PLANTCODE      VARCHAR(10)
		   ,@LS_WORKCENTERCODE VARCHAR(30)
		   ,@LS_ITEMCODE	   VARCHAR(30)
		   ,@LS_ORDERNO		   VARCHAR(30)
		   ,@LS_QTY			   INT
		   ,@LS_UNITCODE       VARCHAR(10)
		   ,@LS_CITEMCODE      VARCHAR(30)
		   ,@LS_CUNITCODE      VARCHAR(10)
	SELECT @LS_PLANTCODE      = A.PLANTCODE
		  ,@LS_WORKCENTERCODE = B.WORKCENTERCODE
		  ,@LS_ITEMCODE       = A.ITEMCODE
		  ,@LS_ORDERNO        = B.ORDERNO
		  ,@LS_QTY            = B.QTY
		  ,@LS_UNITCODE       = B.UNITCODE
		  ,@LS_CITEMCODE      = C.ITEMCODE
		  ,@LS_CUNITCODE      = C.BASEUNIT
	  FROM TB_StockPPrec A WITH(NOLOCK) JOIN TB_FaultRec B WITH(NOLOCK)
										  ON A.LOTNO     = B.NEWLOTNO
								   LEFT JOIN TB_ItemMaster C WITH(NOLOCK)
								          ON B.PLANTCODE = C.PLANTCODE
										 AND B.ITEMCODE  = C.ITEMCODE 
	 WHERE A.LOTNO = @NEWLOTNO

	-- LOT TRACKING에서 SEQ 가져오기
	DECLARE @LI_SEQ INT
	SELECT @LI_SEQ = ISNULL(MAX(SEQ), 0) + 1
	  FROM TP_LotTracking
	 WHERE PLANTCODE = @LS_PLANTCODE
	   AND LOTNO     = @NEWLOTNO

	-- LOT TRACKING INSERT 로직
	-- LOT TRACKING에 남겨주기
	DECLARE @LITQTY INT
	IF @LI_SEQ = 1
	BEGIN
		SET @LITQTY = @LS_QTY
	END
	ELSE
	BEGIN
		SET @LITQTY = NULL
	END
	INSERT INTO TP_LotTracking (PLANTCODE,	   LOTNO,	  SEQ,	   ORDERNO,     WORKCENTERCODE,	    ITEMCODE,     PRODQTY,  UNITCODE,	    CLOTNO,	   CITEMCODE,     CUNITCODE,	 MAKEDATE,	   MAKER)
		    		        VALUES (@LS_PLANTCODE, @NEWLOTNO, @LI_SEQ, @LS_ORDERNO, @LS_WORKCENTERCODE, @LS_ITEMCODE, @LITQTY, @LS_UNITCODE,    @CLOTNO,   @LS_CITEMCODE, @LS_CUNITCODE, @LD_NOWDATE,  @WORKER)
	SET @RS_CODE = 'S'

END
```